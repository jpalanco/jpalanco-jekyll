---
title: "El TM+MM"
date: "2003-04-02"
image: assets/images/TMM.jpg
author: jpalanco
layout: post
tags: [ wap, moviles, hacking ]
categories: [ old-school ]
---


Antes de empezar el art√≠culo en s√≠ creo que debo advertir que la informaci√≥n aqu√≠ contenida es solamente para fines meramente informativos, y que lo que cualquier usuario haga mas all√° de esto depende de el y no me responsabilizo, aclarado √©ste detalle ah√≠ va el articulo:

El TM+MM es el nuevo tipo de cabinas que est√° fabricando Siemens para Telef√≥nica, con mas funcionalidades que las cabinas ‚Äúde toda la vida‚Äù como acceso a internet a trav√©s de adsl, env√≠o de mensajes cortos a m√≥viles y posibilidad de hacer fotos digitales, como creo nosotros no somos de ese tipo de gente que se conforma solo con saber para lo que algo est√° fabricado pasamos a hacer algunas pruebas con las cabinas que ya est√°n funcionando en Zaragoza(Desconozco si est√°n en otros lugares tambi√©n)

![El TM+MM]({{ site.baseurl }}/assets/images/TM+MM.jpg)
El TM+MM

En primer lugar voy a dar una descripci√≥n f√≠sica de  lo que hasta ahora se ha ido instalando(siempre en lugares cerrados y bien vigilados).
Se ha sustituido el frontal de la cabian por uno mas amplio que contiene lo siguiente:

-	Una pantalla TFT de Samsung en color retroiluminada de 11 pulgadas. Resoluci√≥n de 800x600
-	Un teclado alfab√©tico de 50 teclas tipo QWERTY de acero, ligeramente inclinado.
-	Un trackball con dos botones, aunque el bot√≥n secundario ha sido desactivado
-	Altavoces
-	Una webcam
-	Un teclado num√©rico convencional
-	Una caja debajo de la cabina con el router adsl y su fuente de alimentaci√≥n, se supone que un futuro √©sta caja estar√° situada en el techo de las cabinas.

Y pasando al hardware del ordenador que lleva dentro no encontramos con:

-	Una placa SBC industrial.
-	Un microprocesador Pentium a 166 mhz
-	Dos puertos USB(uno de ellos ocupado pro al webcam)
-	Dos puertos serie(uno de ellos se comunica con la placa controladora del sistema de voz)
-	Una tarjeta ethernet
-	128 megabytes de RAM
-	Disco duro de 10 gigabytes
-	La placa que controla el sistema de voz de la cabina, que es la placa de siempre.
 
![Esquema de conexi√≥n]({{ site.baseurl }}/assets/images/TM-Conexion.jpg)
Esquema de conexi√≥n

En cuanto a software:

-	Una distribuci√≥n de Linux RedHat, probablemente una 7.2
-	Kernel 2.4.18
-	FVWM con alogin(inicia autom√°ticamente con un usuario las X)
-	XFree86 4.2.0
-	Navegador basado en Escape que permite la navegaci√≥n, el env√≠o de correo, y env√≠o de mensajes cortos a los tel√©fonos m√≥viles, aparte de eso almacena (se supone para fines estad√≠sticos) de todo lo que hace el usuario(urls visitadas, banners en los que se ha hecho clic...)
 
![Sistema de navegaci√≥n]({{ site.baseurl }}/assets/images/TM-Navegacion.jpg)
Sistema de navegaci√≥n

-	Blackdown's JDK1.1.8
-	Sistema de videoconferencia basado en GnomeMeeting
-	Aplicaci√≥n para controlar la comunicaci√≥n entre placas
-	Un sistema de auto actualizaci√≥n de software mediante el cual se conecta v√≠a https a un servidor para bajar los paquetes que debe actualizar
-	Un servidor de ssh OpenSSH versi√≥n 3.1p1
-	Squid 2.4

En lo que se refiere a la seguridad de la cabina de momento no hemos conseguido nada, solo tiene abiertos hacia el exterior los puertos 22(el servidor de ssh parchado) y el puerto 80(supuestamente por el puerto que se actualiza), el resto de puestos est√°n cerrados. Solamente se puede salir de la aplicaci√≥n principal abriendo la puerta de la cabina, o con la tarjeta de t√©cnico de Telef√≥nica(cosas que nos son imposibles, aprovecho para recordar que todas las cabinas de √©ste tipo est√°n en recintos cerrados y vigilados), el lilo corre bajo chroot y evita que se pueda arrancar en modo monousuario o introducir cualquier tipo de comando. Lo que aun no hemos probado es intentar explotar alg√∫n bug del navegador, que no permite bajar ficheros, animaciones de flash, tambi√©n desconocemos si con alg√∫n tipo de explorador bajo Java (que si que interpreta) podr√≠a hacer algo.
La memoria t√©cnica de la cabina dice:

> Para evitar ataques externos de tipo hacker, se emplea la funcionalidad de filtrado de paquetes por Kernel, la cual rechaza los paquetes fragmentados.

Que aun no sabemos muy bien a que narices se refiere pero bueno üòà

Si se le hace un escaneo con Nessus encuentra dos vulnerabilidades graves en el servidor de ssh pero ninguna funciona con su debido exploit, pero aun as√≠, √©stas son las dos vulnerabilidades graves que encuentra:

**El host esta corriendo una version de OpenSSH anterior a la 3.2.1**

Existe un buffer overflow en √©ste demonio si esta habilitado el AFS en su sistema, o si las opciones de KerberosTgtPassing o AFSTokenPassing est√°n habilitadas. Dependiendo del escenario la vulnerabilidad puede ser evitada habilitando UsePrivilegeSeparation.
Las versiones anteriores a la 2.9.9 son vulnerables a un exploit para root remoto. Las versiones anteriores a la 3.2.1 son vulnerables a un exploit para root local.

Soluci√≥n: Actualizar la versi√≥n de OpenSSH
- Riesgo: Alto
- CVE : CAN-2002-0575
- BID : 4560
- Nessus ID : 10954

**El host esta corriendo una version de OpenSSH anterior a la 3.4**

Hay un fallo en esta versi√≥n que puede ser explotado remotamente para dar al atacante una shell en el host.

Soluci√≥n: Actualizar OpenSSH a la versi√≥n 3.4
- Riesgo: Alto
- CVE : CAN-2002-0639, CAN-2002-0640
- BID : 5093
- Nessus ID : 11031

Creo conveniente aclarar que el control de las llamadas por voz lo sigue haciendo la cabina por hardware, que solo se comunica con el ordenador para transmitirles los mensajes para el usuario, por lo que no creo que fuese posible efectuar llamadas telef√≥nicas gratis aunque se tomase el control de la cabina, aunque creo que se ser√≠a posible enviar sms y navegar por internet de manera gratuita.

Ips de algunas de las cabinas:
- 80.37.142.174

Urls de inter√©s:
- [SIEMENS ELASA, el fabricante de las cabinas](http://www.elasa.siemens.es)
- [Memoria del TM+MM](http://www.cting.upm.es/propuestas-premio/2002/memoria%20TM+MM.pdf )
